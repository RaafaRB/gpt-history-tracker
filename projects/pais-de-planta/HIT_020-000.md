HIT_020 - Diagnostic AI as Single Source of Truth

This HIT consolidated the diagnostic AI as the single source of truth for disease and treatment domains. The scope was to expand the diagnostic contract to generate and persist all critical model fields, eliminating silent NULL states and turning diagnostics into a complete domain.

The Pydantic diagnostic schema was expanded to require fields such as display_title, severity, progression_speed, symptoms, causes, and an ordered list of treatments. Validators were added to prevent partial, shallow, or inconsistent responses, including non empty list checks, sequential treatment order validation, and non generic descriptions.

On the backend, the diagnostic service now uses the validated AIPlantDiagnostic payload as the single source of truth, fully persisting PlantDisease data (severity, progression_speed, symptoms, causes, description) and DiseaseTreatment data (step_order, action, materials, estimated_days). No additional AI calls were introduced and no silent defaults are used.

During verification, it was confirmed that healthy diagnostics do not create diseases, PlantDisease records are not duplicated by issue_code, and AI validation errors fail loudly and block persistence. It was observed that DiseaseTreatment records may be created more than once for the same disease, a behavior explicitly accepted in this HIT pending a future decision on versioning or deduplication.

To maintain response compatibility, JSON array deserialization was added at the Pydantic boundary without altering the database structure.

At the end of HIT_020, all critical fields are guaranteed for new diagnostics. The diagnostic domain is now complete and ready to be consumed by a frontend based on real data.